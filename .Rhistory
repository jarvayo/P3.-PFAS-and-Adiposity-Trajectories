##### LOAD PACKAGES
library("dplyr")
library("sas7bdat")
library("haven")
library("data.table")
library("readxl")
##### LOAD DATASET
PFAS <- read_sas("C:/Users/jarva/Desktop/James-Todd Lab/P2.PFASandWeightTrajectories/Data/ja_030823.sas7bdat")
FFQ <- read_sas("C:/Users/jarva/Desktop/James-Todd Lab/P2.PFASandWeightTrajectories/Data/ja_062922_FFQ.sas7bdat")
DIET <- read_excel("C:/Users/jarva/Desktop/James-Todd Lab/P1.PFASandBP/Data/DIET.xlsx")
# ADD FFQ VARIABLES TO PFAS DATASET
FFQ <- subset(FFQ, select = c(aid, fish_d_f1, dark_meat_f1))
PFAS <- merge(PFAS, FFQ, by = "aid")
PFAS <- merge(PFAS, DIET, by = "aid")
##### CHECK FOR DUPLICATE IDS IN THE DATASET
sum(duplicated(PFAS$familyid)) # 28 DUPLICATES
# DROP THE SECOND DUPLICATE
DUPS <- PFAS[duplicated(PFAS$familyid),]
PFAS <- PFAS[order(PFAS$familyid),]
PFAS <- PFAS[!duplicated(PFAS$familyid),]
View(FFQ)
View(DUPS)
##### LOAD PACKAGES
library("sas7bdat")
library("haven")
library("data.table")
library("readxl")
##### LOAD DATASET
# PFAS <- read.sas7bdat("C:/Users/jarva/Desktop/James-Todd Lab/P1.PFASandBP/Data/ja_080622.sas7bdat")
PFAS <- read.sas7bdat("C:/Users/jarva/Desktop/James-Todd Lab/P1.PFASandBP/Data/ja_062922_FFQ.sas7bdat")
DASH <- read_excel("C:/Users/jarva/Desktop/James-Todd Lab/P1.PFASandBP/Data/Dash_Diet.xlsx")
##### LOAD DATASET
# PFAS <- read.sas7bdat("C:/Users/jarva/Desktop/James-Todd Lab/P1.PFASandBP/Data/ja_080622.sas7bdat")
PFAS <- read.sas7bdat("C:/Users/jarva/Desktop/James-Todd Lab/P1.PFASandBP/Data/ja_062922_FFQ.sas7bdat")
DASH <- read_excel("C:/Users/jarva/Desktop/James-Todd Lab/P1.PFASandBP/Data/Dash_Diet.xlsx")
##### MERGE DATASETS
PFAS <- merge(PFAS, DASH, by = "aid")
##### LOAD PACKAGES
library("sas7bdat")
library("haven")
library("data.table")
library("readxl")
##### LOAD DATASET
# PFAS <- read.sas7bdat("C:/Users/jarva/Desktop/James-Todd Lab/P1.PFASandBP/Data/ja_080622.sas7bdat")
PFAS <- read.sas7bdat("C:/Users/jarva/Desktop/James-Todd Lab/P1.PFASandBP/Data/ja_062922_FFQ.sas7bdat")
DASH <- read_excel("C:/Users/jarva/Desktop/James-Todd Lab/P1.PFASandBP/Data/Dash_Diet.xlsx")
DIET <- read_excel("C:/Users/jarva/Desktop/James-Todd Lab/P1.PFASandBP/Data/Dash_Diet.xlsx")
DIET <- read_excel("C:/Users/jarva/Desktop/James-Todd Lab/P1.PFASandBP/Data/Diet.xlsx")
BP <- read.sas7bdat("C:/Users/jarva/Desktop/James-Todd Lab/P1.PFASandBP/Data/mage.sas7bdat")
sum(duplicated(PFAS$familyid)) # 13 DUPLICATE FAMILY IDs
DUPS <- PFAS[duplicated(PFAS$familyid),]
PFAS <- PFAS[order(familyid),]
View(PFAS)
PFAS <- PFAS[order(PFAS$familyid),]
PFAS <- PFAS[!duplicated(PFAS$familyid),]
##### MERGE DATASETS
PFAS <- merge(PFAS, DASH, by = "aid")
##### MERGE DATASETS
PFAS <- merge(PFAS, DIET, by = "aid")
PFASBP <- merge(BP, PFAS, by = "aid")
##### DROP BP MEASURES TAKEN DURING THE FIRST TRIMESTER
PFASBP <- subset(PFASBP, ga_days >83) # 3943 1ST TRIMESTER MEASURES DROPPED
##### ADD A "COUNT" VARIABLE TO TELL US HOW MANY BP MEASURES EACH PERSON HAS
setDT(PFASBP)[, count := uniqueN(ga_days), by = aid]
##### ADD A "DUP" VARIABLE TO COUNT NUMBER OF DUPLICATED IDs
PFASBP$dup_num <- length(unique(PFASBP$ga_days)) == nrow(PFASBP)
PFASBP$dup_num <- sequence(table(PFASBP$aid))
##### DROP INDIVIDUALS WITH LESS THAN 2 BP MEASURES
PFASBP <- subset(PFASBP, PFASBP$count >=2)
##### ONLY KEEP THE FIRST OBSERVATION PER UNIQUE AID
PFASBP <- subset(PFASBP, dup_num == 1)
##### SEE LIST OF VARIABLES
#ls(PFASBP)
PFASBP_1 <- subset(PFASBP_0, !is.na(PFOS)) # MISSING PFASBP DATA (N = 482)
##### DROP UNNECESSARY VARIABLES
PFASBP_0 <- subset(PFASBP, select = c(familyid, aid, ga_days, mom_agey_bp, g_age_days_COLL_D_BLD1, sys,
dias, PFOS, PFOA, PFNA2, PFHxS, Me_PFOSA_AcOH2, Et_PFOSA_AcOH,
bmi_mom_prepreg_d, race2_mom_epi_epia_d,parity_d, coll_grad,
gt70k, income_hh_epq_epqa_d, htn_rx_preg, t1diab_mom_epi_epia_d,
t2diab_mom_epi_epia_d, highbp_mom_epi_epia_d, mod_pre_d,
vig_pre_d, smokpreg_final_d,alc_d_f1,alc_d_bef_learn_f1, married_cohab,
alc_d_aft_learn_f1, mom_firstperiod_12y, fish_d_f1, dark_meat_f1,
dash_f1, dash_f2, dash_f12, count))
summary(PFASBP_0$Et_PFOSA_AcOH) # INDIVIDUALS ARE MISSING ALL OR NONE OF EACH PFASBP (N = 482)
##### EXCLUDE INELEGIBLE PARTICIPANTS
PFASBP_1 <- subset(PFASBP_0, !is.na(PFOS)) # MISSING PFASBP DATA (N = 482)
table(PFASBP_1$highbp_mom_epi_epia_d)
PFASBP_2 <- subset(PFASBP_1, highbp_mom_epi_epia_d != 1) # HISTORY OF HYPERTENSION (N = 88)
PFASBP_3 <- subset(PFASBP_2, t1diab_mom_epi_epia_d != 1 & t2diab_mom_epi_epia_d != 1) # HISTORY OF DIABETES (N = 10)
table(PFASBP_3$htn_rx_preg)
PFASBP_4 <- subset(PFASBP_3, htn_rx_preg !=1) # PAST/CURRENT USE OF BP MEDICATION (N = 9)
##### LOAD PACKAGES
library("sas7bdat")
library("haven")
library("data.table")
library("readxl")
##### LOAD DATASET
# PFAS <- read.sas7bdat("C:/Users/jarva/Desktop/James-Todd Lab/P1.PFASandBP/Data/ja_080622.sas7bdat")
PFAS <- read.sas7bdat("C:/Users/jarva/Desktop/James-Todd Lab/P1.PFASandBP/Data/ja_062922_FFQ.sas7bdat")
DIET <- read_excel("C:/Users/jarva/Desktop/James-Todd Lab/P1.PFASandBP/Data/Diet.xlsx")
BP <- read.sas7bdat("C:/Users/jarva/Desktop/James-Todd Lab/P1.PFASandBP/Data/mage.sas7bdat")
##### CHECK FOR DUPLICATE IDS IN THE 2 DATASETS CREATED FOR ANALYSIS
sum(duplicated(PFAS$familyid)) # 13 DUPLICATE FAMILY IDs
# DROP THE SECOND DUPLICATE
DUPS <- PFAS[duplicated(PFAS$familyid),]
PFAS <- PFAS[order(PFAS$familyid),]
PFAS <- PFAS[!duplicated(PFAS$familyid),]
##### MERGE DATASETS
PFAS <- merge(PFAS, DIET, by = "aid")
PFASBP <- merge(BP, PFAS, by = "aid")
##### DROP BP MEASURES TAKEN DURING THE FIRST TRIMESTER
PFASBP <- subset(PFASBP, ga_days >83) # 3943 1ST TRIMESTER MEASURES DROPPED
##### ADD A "COUNT" VARIABLE TO TELL US HOW MANY BP MEASURES EACH PERSON HAS
setDT(PFASBP)[, count := uniqueN(ga_days), by = aid]
##### ADD A "DUP" VARIABLE TO COUNT NUMBER OF DUPLICATED IDs
PFASBP$dup_num <- length(unique(PFASBP$ga_days)) == nrow(PFASBP)
PFASBP$dup_num <- sequence(table(PFASBP$aid))
##### DROP INDIVIDUALS WITH LESS THAN 2 BP MEASURES
PFASBP <- subset(PFASBP, PFASBP$count >=2)
##### ONLY KEEP THE FIRST OBSERVATION PER UNIQUE AID
PFASBP <- subset(PFASBP, dup_num == 1)
##### SEE LIST OF VARIABLES
#ls(PFASBP)
##### DROP UNNECESSARY VARIABLES
PFASBP_0 <- subset(PFASBP, select = c(familyid, aid, ga_days, mom_agey_bp, g_age_days_COLL_D_BLD1, sys,
dias, PFOS, PFOA, PFNA2, PFHxS, Me_PFOSA_AcOH2, Et_PFOSA_AcOH,
bmi_mom_prepreg_d, race2_mom_epi_epia_d,parity_d, coll_grad,
gt70k, income_hh_epq_epqa_d, htn_rx_preg, t1diab_mom_epi_epia_d,
t2diab_mom_epi_epia_d, highbp_mom_epi_epia_d, mod_pre_d,
vig_pre_d, smokpreg_final_d,alc_d_f1,alc_d_bef_learn_f1, married_cohab,
alc_d_aft_learn_f1, mom_firstperiod_12y, fish_d_f1, dark_meat_f1,
dash_f1, dash_f2, dash_f12, count))
PFASBP_1 <- subset(PFASBP_0, !is.na(PFOS)) # MISSING PFASBP DATA (N = 482)
PFASBP_1 <- subset(PFASBP_1, g_age_days_COLL_D_BLD1 <= 84) # MISSING 1ST TRIMESTER PFAS DATA (N = 221)
PFASBP_2 <- subset(PFASBP_1, highbp_mom_epi_epia_d != 1) # HISTORY OF HYPERTENSION (N = 88)
table(PFASBP_2$t1diab_mom_epi_epia_d)
table(PFASBP_2$t2diab_mom_epi_epia_d)
PFASBP_3 <- subset(PFASBP_2, t1diab_mom_epi_epia_d != 1 & t2diab_mom_epi_epia_d != 1) # HISTORY OF DIABETES (N = 10)
table(PFASBP_3$htn_rx_preg)
PFASBP_4 <- subset(PFASBP_3, htn_rx_preg !=1) # PAST/CURRENT USE OF BP MEDICATION (N = 9)
